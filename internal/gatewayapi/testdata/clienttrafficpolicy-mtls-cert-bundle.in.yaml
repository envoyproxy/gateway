clientTrafficPolicies:
  - apiVersion: gateway.envoyproxy.io/v1alpha1
    kind: ClientTrafficPolicy
    metadata:
      namespace: default
      name: target-gateway-1
    spec:
      targetRefs:
        - group: gateway.networking.k8s.io
          kind: Gateway
          name: gateway-1
      headers:
        xForwardedClientCert:
          mode: Sanitize
          certDetailsToAdd:
            - Cert
      tls:
        clientValidation:
          caCertificateRefs:
            - group: ""
              name: tls-bundle-secret
              namespace: default
gateways:
  - apiVersion: gateway.networking.k8s.io/v1
    kind: Gateway
    metadata:
      namespace: default
      name: gateway-1
    spec:
      gatewayClassName: envoy-gateway-class
      listeners:
        - name: http-1
          protocol: HTTPS
          port: 443
          allowedRoutes:
            namespaces:
              from: Same
          tls:
            mode: Terminate
            certificateRefs:
              - name: tls-bundle-secret
                namespace: default
httpRoutes:
  - apiVersion: gateway.networking.k8s.io/v1
    kind: HTTPRoute
    metadata:
      namespace: default
      name: httproute-1
    spec:
      parentRefs:
        - namespace: default
          name: gateway-1
          sectionName: http-1
      rules:
        - backendRefs:
            - name: service-1
              port: 8080
secrets:
  - apiVersion: v1
    kind: Secret
    metadata:
      namespace: default
      name: tls-bundle-secret
    type: kubernetes.io/tls
    data:
      # this cert bundle contains one valid certs and one invalid cert.
      # first pem block is invalid, second pem block is valid.
      ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR2ekNDQXFlZ0F3SUJBZ0lVQ00wbkV5NnlhbXZwejhFUGI1anY3S1hkRGpJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2J6RUxNQWtHQTFVRUJoTUNWVk14Q3pBSkJnTlZCQWdNQWxaQk1SRXdEd1lEVlFRSERBaFRiMjFsUTJsMAplVEVUTUJFR0ExVUVDZ3dLUlc1MmIzbFFjbTk0ZVRFUU1BNEdBMVVFQ3d3SFIyRjBaWGRoZVRFWk1CY0dBMVVFCkF3d1FiWFJzY3k1bGVHRnRjR3hsTG1OdmJUQWVGdzB4T1RFeU16RXhOVEF3TURGYUZ3MHlNREF4TURFeE5UQXcKTURGYU1HOHhDekFKQmdOVkJBWVRBbFZUTVFzd0NRWURWUVFJREFKV1FURVJNQThHQTFVRUJ3d0lVMjl0WlVOcApkSGt4RXpBUkJnTlZCQW9NQ2tWdWRtOTVVSEp2ZUhreEVEQU9CZ05WQkFzTUIwZGhkR1YzWVhreEdUQVhCZ05WCkJBTU1FRzEwYkhNdVpYaGhiWEJzWlM1amIyMHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUsKQW9JQkFRREtYOXRIaFJqQVVrcnVUdldGNndJbkIyeWpOUFFRZml6azcrandES3VPOWwxdmRhUkN3MEl6bTJqUgpyem9ncVA0WU5CM3hGbWs5SVh3MEFqWGxSVVJqb1lzbGZTdGhwSE1iTlV6OG1sTW5ZUWtIbG5BTVFDOW5xajBoClQrQmJlcmRvVXExVlhZclYxTHJRUzVsN1hsQTNJMFZhSlI3QktvUzhsRXFmeVBia2N6ZGlia2hyTlhSYWprd2IKZG5WR2F5Z0J0S0RoQUgzT3YvQzRrRjlVWnhMZ3lVbW1HUjRKUXNyRzJHSlRyM1ZnUXQrdVVBQ014allWUStMVwpqa3JzTXYwaW9WWExIWWk3ck5aaG1BbXBOSXcwSVdJUDFXc01ucDhpNWQ0aVF4d0cwVFNFREZSZndQNWdXdzdVCnhhSnR2bnkzTDJLTndveCtpZnRPQXY2SGU4ZkxBZ01CQUFHalV6QlJNQjBHQTFVZERnUVdCQlE3WGZjM1ZwZ2EKc21qOXVmOTlpYVhQa2U3Qkl6QWZCZ05WSFNNRUdEQVdnQlE3WGZjM1ZwZ2FzbWo5dWY5OWlhWFBrZTdCSXpBUApCZ05WSFJNQkFmOEVCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQWZFdEIrQko5cU9lM2Jtd2hBCjdkbzFpSnAwUWtzZHg0OE1ic09YNTA1dTRZKzdHUHR6MTNBbEpDb3BPdEFZY2IyTXoxMm5hOWlYbUpVRnB4d2EKWEZFZ1MvM3JhVXF6dVBybUxUVzRZNW1kTlNuVHgrV2tPOGN2anVZM3hLcEVRT2xsY3lNMzJqcWQveWNGQWQ0egpxeDdaZlA0NzVIOWFUWHZDakRpdXVPLzdvQ21zU1d2SjRkbGxuLyszNXoxV2dPOHc5TmhGNEhMNDJUajh4Nyt1CnB3TUp3M2d2TTVWdzBZWEpXOFRIcjM3MXExT0ZFRVRoeXJVYWpvRVZDT0RZQ2gzRldlamxOdmJ2RFd3YjJ1U2IKS3JYd0tRZmMxU1F3RWhuMjBCU21RWFRHY01YZUkzUTZpUzYzdTBQeWRUemdONEJEbTlNRnlVWFBWNk9zbVQwQgpkT3dnCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR3VENDQXFtZ0F3SUJBZ0lVWTNmMFI2SExoVGNJU2FIaURhUkF0d1dHMDJrd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2J6RUxNQWtHQTFVRUJoTUNWVk14Q3pBSkJnTlZCQWdNQWxaQk1SRXdEd1lEVlFRSERBaFRiMjFsUTJsMAplVEVUTUJFR0ExVUVDZ3dLUlc1MmIzbFFjbTk0ZVRFUU1BNEdBMVVFQ3d3SFIyRjBaWGRoZVRFWk1CY0dBMVVFCkF3d1FiWFJzY3k1bGVHRnRjR3hsTG1OdmJUQWdGdzB5TlRFeU1UTXhOREl3TXpGYUdBOHlNVEkxTVRFeE9URTAKTWpBek1Wb3diekVMTUFrR0ExVUVCaE1DVlZNeEN6QUpCZ05WQkFnTUFsWkJNUkV3RHdZRFZRUUhEQWhUYjIxbApRMmwwZVRFVE1CRUdBMVVFQ2d3S1JXNTJiM2xRY205NGVURVFNQTRHQTFVRUN3d0hSMkYwWlhkaGVURVpNQmNHCkExVUVBd3dRYlhSc2N5NWxlR0Z0Y0d4bExtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0MKQVFvQ2dnRUJBT3Jxc21LS20xd1NZNlF2dm9vQkY1dGZVanByYWNwb3lERTVJVGVxMVcyeHVMRHBzWG9CTTZJVApzSG5LSWM3a3gzcEZmTk5YZG5TVE1PYU5CNEoycEIvUG5EdjhMK3FWN2dPYS91bGdjMnpJUVpCaVFtWEt0WTNFClNHL0ZQZmM1YmZ0bC9KcktHaExkaTdSNm40SkxIbGw0OVgyZ0xZc2hvM3ZNTXprQXJRUTVpaVVCRDlnSE1GVU4KV1loOTRONnQyQUxxY3A4cTZQZ2Y5R0Y5Z2Y2OGMzSWtnNlBQL3FTR2dQTTRMWHZQYlgyM0ZqUjBPdzcyTE8ybwphbDdTMVNwWFM5MGJyV2VXWThwMFBocVd1QnBSeWl4T1JFcWltY1BndXdGTisyYi9KZVJpeFlldTJjZisrYXU5ClhVWkFyYmc2UDJsNDNjSC9EZUNCbWdtTU9lVjExY0VDQXdFQUFhTlRNRkV3SFFZRFZSME9CQllFRksvTTVyK0gKMVNQdFhlOHBzd2srcmh3T1JFUW5NQjhHQTFVZEl3UVlNQmFBRksvTTVyK0gxU1B0WGU4cHN3aytyaHdPUkVRbgpNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBRnh5NmNpNVl3eVhndDcrCisxdjF0LzVsSS9vTytGNVZROWxCY29HK3UzRDduTGFtdkpEdFl0TkdxbFFZUVEwYXpXeDFqaEpjTzNQMnhGcUIKdTNJUU5GQ3VrdlZNVDFnd05UUDQwMFRQcmptOWFJblVYcE0wRUZtbXp0R0o4akJWdkVmc0kxK0ZUWnR4ckdzSQpBeGZpM1JzYjJISWZCVStzOEFpRTdOb2lVSFlJWi9pL21wNGswczlZVzNBQk9sT2duY0w1eEsyeWdhMGJGeW1HCjNmYVBrSEVURHVpaUVoMnR6cThuUThETWl1TVZwUEtzeEZJOWtVQ1FhcVZZZ2lKVjVrVjVZZGRyVHgyMC9wVWwKQ1RNVS9nd1pSUzVBMlJ1ZHQvWDZKMXNhRUFROXhHcTVNQ25wczFnazVXV09sRTJhZXZQYkRsTmV6RkVRcjJabAp4OXJKOTR3PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
      tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRREdOcnp0MlcwZHdySEYKUUNNVWhyMmNkdG5VQjBZWWFHMWlwNVB3WFBGUkw1eUJTQ0JnOE5RQkNucVpMSW0ydUpmdy9UdnNnQ0pMd2UwVwpSMjgzaXUvOUlDWkVWSWpyRk03WFA0N1hzVTYvSitZSkFOSUlzc1JnSUtIVGw5Qm5Ra0EzS2ZySEo4YXFCUW9XClRxakZscVBZQnE0RjV2dXNIUDNrVUV2TVpmSDk1bVA3anhsckJLTkQrS1Q1aXNjWktLck5ZUFZEVkhXRzVwUEUKN2svUFVvTkFnQVBFTWhhUmk4VW81MFA2UkFsVW1IcGNleU40cjVZZ2h1NW1hU1ZVdUFYNVB4a2pSTzlkc3RlZAorM0V5UkNvTkRNNjVtcXVXMVhETFdTYU1GZHVmVVdCSm5wNUxUVm9yOWtJY2hxOUZsemhkRm4zTlRWVmVmK2E4CjVneURyVXFKQWdNQkFBRUNnZ0VBQnp0U2g4NndhRG1sQU8zRU5JNFk4aEhmcnkzSHdvRmhoNkZXYUsvZmFieWcKdGhKNEJKN0NGcnFpT3A5R2MvNmIrVGNvQ0tBcjFYM3J1a01jeCt3L1hCOGdQa3NqbkFqQmtOYTVEYk5pb2Q5TAp0REE0anQyRTJYNnA5aWdhWlZZUENvN2R5ZHZiUFVpYlNRYVJmNTlZSVh3c1BSQzVHeHNMV1ZrNDlyOW1jRUszCk9EVjlFMFZJNHZ6bWNFaGxoN1hORHB3M1ZDL1VFTVRRaFhhU1Y5Nk9kaWJPOHU5L2JrTmRKc2JXRkpRcXVQYmgKSUtCT3hiU1Q2WkN1NHUrN3ZIK2lrNWF4TkhybkFsUStlUlk5VVI5M0lpdk1hVVdybEJkeG55OStZUm5WVUdoUwpuenYweUY2T3VoZnk2Y25LZjRxYlhMVVJLK1orUml2TmZCYkVldWlDZ1FLQmdRRDBCVDg2NDQvSEhYcnlQRVdCCjRBUFBPSCtnb3FZMDRqODM0eUNpcFpQM1FBU0F5UGlCWEtsdlpLOU14NGE0YlBZM1dWQUpWc2JRV2pLd1ZBUE8KSnZ5SXAyTWZ1SSs0Q0M3ODkvUitwTkdpRmlsUDdIRjBhTHVMUVU0ZVNJcXdZMjJmTjBVWEpJNmpsdzJvWkdEWAp6TWJ3TVdjSDB0K0pDTDAzNFYvK2YvcFp5UUtCZ1FEUDhjK1RYQ2V0S2h3Q2dDZUpFcUwrNHZzeGN4VEdmNzlJCmxLbVc5QmtSOC9Iaks2UkFUYVdjb3hNV21wd3phOWoyUE5ham5GZzJ5dTU1VmtubFRMazAxTDVaTkFXcTFQQnkKa3NBcFVtRkxCVzRRUnMzalFoV0pwWEJ4TDQveFBkK2hDUlNNdzU3VEQvNzhNWGMwN2l2M1ZzdWE0aDNXaXNSYQpSVGEvajkvS3dRS0JnR01XVGxxblZSYlJqYjhYWWxJZW1PMW9UOHIyd083d2dDTTlnMThJUlZFOUdaY0NCSWJqCkRacENGRHpsT0h0akk0Zk9LSVhpU3RFSUQxVXlpR2tKdzducDNvSmUrMTBMVmFrN05uakdqS2w0dmtYS0NUZnYKMzFmb3FNUDdTUFhmS2dCZy9Sa3NxdzhhbzEwaGhZR2JrWnl2TXRzbWNjYS9XYlo3T2ZPcUhBcWhBb0dCQUpmUAo3RUdqRi94ZUw5RExpeEdSbjVvQ1VHMUxuVEZGOW5xZ3ZpZE0wamkvSmlzNW8xS20zVys3eHFYTC9wbXo5TlBnCm1yc2IyM00xT0dFeFZBV3B1OVVNTkdPZmpUdW85bHBQTlNkMTB6NFlHc0NiVUpqSG1EM0RvSkdocmE3c0F5WG8KSVM2YmFvcWd0UUdkZzNBTEtlSUxaZDRQa3NVY3pqa3hLc1V6M3FpQkFvR0JBTXZEMUZUTkIzUVcrVDA4ZC9iQQpUTDJodDBUZEpLbjNiQjJiMkdXTmlnUmE3QlFaaEJ3R1o3ODZ4cm4xbzFrck1CUEVJS3hQejhERFFBRVFvbWplCmdab1RpbHl5b2Fnc2dhU0NSTW5HTDFtSG5JVTkwakNvOGpoaTkxOW0xS0dEakFhL21jam55UUEvdGd0WVBkM0sKa0tMSXVONng5aDJoOUhGSTQyT0FDM1EwCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
      tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURuVENDQW9XZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREJ2TVFzd0NRWURWUVFHRXdKVlV6RUwKTUFrR0ExVUVDQXdDVmtFeEVUQVBCZ05WQkFjTUNGTnZiV1ZEYVhSNU1STXdFUVlEVlFRS0RBcEZiblp2ZVZCeQpiM2g1TVJBd0RnWURWUVFMREFkSFlYUmxkMkY1TVJrd0Z3WURWUVFEREJCdGRHeHpMbVY0WVcxd2JHVXVZMjl0Ck1DQVhEVEkxTVRJeE16RTFNREV5TWxvWUR6SXhNalV4TVRFNU1UVXdNVEl5V2pCdk1Rc3dDUVlEVlFRR0V3SlYKVXpFTE1Ba0dBMVVFQ0F3Q1ZrRXhFVEFQQmdOVkJBY01DRk52YldWRGFYUjVNUk13RVFZRFZRUUtEQXBGYm5adgplVkJ5YjNoNU1SQXdEZ1lEVlFRTERBZEhZWFJsZDJGNU1Sa3dGd1lEVlFRRERCQnRkR3h6TG1WNFlXMXdiR1V1ClkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXhqYTg3ZGx0SGNLeHhVQWoKRklhOW5IYloxQWRHR0dodFlxZVQ4Rnp4VVMrY2dVZ2dZUERVQVFwNm1TeUp0cmlYOFAwNzdJQWlTOEh0RmtkdgpONHJ2L1NBbVJGU0k2eFRPMXorTzE3Rk92eWZtQ1FEU0NMTEVZQ0NoMDVmUVowSkFOeW42eHlmR3FnVUtGazZvCnhaYWoyQWF1QmViN3JCejk1RkJMekdYeC9lWmorNDhaYXdTalEvaWsrWXJIR1NpcXpXRDFRMVIxaHVhVHhPNVAKejFLRFFJQUR4RElXa1l2RktPZEQra1FKVkpoNlhIc2plSytXSUlidVpta2xWTGdGK1Q4WkkwVHZYYkxYbmZ0eApNa1FxRFF6T3VacXJsdFZ3eTFrbWpCWGJuMUZnU1o2ZVMwMWFLL1pDSElhdlJaYzRYUlo5elUxVlhuL212T1lNCmc2MUtpUUlEQVFBQm8wSXdRREFkQmdOVkhRNEVGZ1FVY0JmUXBidDZYNzZZY2dIQkZ5ZXZKVDNsQkNrd0h3WUQKVlIwakJCZ3dGb0FVcjh6bXY0ZlZJKzFkN3ltekNUNnVIQTVFUkNjd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQgpBTXdBWVord3dRR0FnazJ1b3Z0MEU3TjhCWlVKbG1lNW1scEcvYm5qRU5KSlBGQnFONGg3Wnl1cWc5OFFSd2srClZYZHhlQ3AxSWRCTGk4MFRTbjRtVTk1VTV4Lzg5T0oxWlpqZytub1dvY1dydUFlTW8xa2RQc2lkai9TWXBIYksKOVNDZVJUVm5xcDBtcER2WjA0M2tvZzNWZkJzNGhaZEhIblBadnNqbnZrS1pob2dUcVNSak5NdU9WdU9TYU5YaQo2SFd6ZTFDalgyZDhPd1JOaUhtMjg2Z1JoZjFxcHBtaThxK3kvbkFuRk16U0VlcCs2UkhTczh0N0FiYUU0NTRmCk56eXJNaTlhaXJmK0w0ajBjQ2JvQW1ieTZlZUZDNUlIK1B0YXpCNGd4K0pKT1MrTmFxd3pTZFh0REJTdGxKdkYKOHBpY2t0WUJ0NzdrZmJqcWxKaFJEdkU9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
