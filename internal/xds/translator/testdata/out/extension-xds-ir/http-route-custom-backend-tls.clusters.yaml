- circuitBreakers:
    thresholds:
    - maxRetries: 1024
  connectTimeout: 10s
  dnsLookupFamily: V4_PREFERRED
  ignoreHealthOnHostRemoval: true
  lbPolicy: CLUSTER_PROVIDED
  loadBalancingPolicy:
    policies:
    - typedExtensionConfig:
        name: envoy.load_balancing_policies.least_request
        typedConfig:
          '@type': type.googleapis.com/envoy.extensions.load_balancing_policies.least_request.v3.LeastRequest
          localityLbConfig:
            localityWeightedLbConfig: {}
  name: custom-backend-dest
  originalDstLbConfig:
    httpHeaderName: x-gateway-destination-endpoint
    useHttpHeader: true
  perConnectionBufferLimitBytes: 32768
  transportSocket:
    name: envoy.transport_sockets.tls
    typedConfig:
      '@type': type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.UpstreamTlsContext
      commonTlsContext:
        combinedValidationContext:
          defaultValidationContext:
            matchTypedSubjectAltNames:
            - matcher:
                exact: inference-pool.example.com
              sanType: DNS
          validationContextSdsSecretConfig:
            name: policy-btls-for-inference-pool/default-ca
            sdsConfig:
              ads: {}
              resourceApiVersion: V3
      sni: inference.example.com
  type: ORIGINAL_DST
  typedExtensionProtocolOptions:
    envoy.extensions.upstreams.http.v3.HttpProtocolOptions:
      '@type': type.googleapis.com/envoy.extensions.upstreams.http.v3.HttpProtocolOptions
      autoConfig:
        http2ProtocolOptions:
          initialConnectionWindowSize: 1048576
          initialStreamWindowSize: 65536
        httpProtocolOptions: {}
