<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 12px; fill: #34495e; }
      .label { font-family: Arial, sans-serif; font-size: 11px; fill: #2c3e50; }
      .component { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .gateway { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .service { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .external { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .infrastructure { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .flow-label { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .zone { fill: none; stroke: #bdc3c7; stroke-width: 2; stroke-dasharray: 5,5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" class="title">Envoy Gateway Reference Architecture</text>
  <text x="600" y="50" text-anchor="middle" class="subtitle">Production deployment in enterprise environment</text>
  
  <!-- Internet/External Zone -->
  <rect x="50" y="80" width="1100" height="120" class="zone" rx="10"/>
  <text x="70" y="105" class="label">Internet / External Traffic</text>
  
  <!-- External Users -->
  <rect x="100" y="120" width="100" height="60" class="external" rx="5"/>
  <text x="150" y="145" text-anchor="middle" class="label">Web Users</text>
  <text x="150" y="160" text-anchor="middle" class="label">Mobile Apps</text>
  
  <!-- External APIs -->
  <rect x="250" y="120" width="100" height="60" class="external" rx="5"/>
  <text x="300" y="145" text-anchor="middle" class="label">Partner APIs</text>
  <text x="300" y="160" text-anchor="middle" class="label">Third-party</text>
  
  <!-- Load Balancer -->
  <rect x="450" y="120" width="100" height="60" class="infrastructure" rx="5"/>
  <text x="500" y="145" text-anchor="middle" class="label">Cloud LB</text>
  <text x="500" y="160" text-anchor="middle" class="label">(ALB/NLB)</text>
  
  <!-- CDN -->
  <rect x="600" y="120" width="100" height="60" class="infrastructure" rx="5"/>
  <text x="650" y="145" text-anchor="middle" class="label">CDN</text>
  <text x="650" y="160" text-anchor="middle" class="label">(CloudFlare)</text>
  
  <!-- Edge/DMZ Zone -->
  <rect x="50" y="220" width="1100" height="140" class="zone" rx="10"/>
  <text x="70" y="245" class="label">Edge / DMZ Zone</text>
  
  <!-- Envoy Gateway Control Plane -->
  <rect x="100" y="260" width="180" height="80" class="gateway" rx="5"/>
  <text x="190" y="285" text-anchor="middle" class="label">Envoy Gateway</text>
  <text x="190" y="300" text-anchor="middle" class="label">Control Plane</text>
  <text x="190" y="315" text-anchor="middle" class="label">• Gateway API Controller</text>
  <text x="190" y="330" text-anchor="middle" class="label">• xDS Configuration</text>
  
  <!-- Envoy Proxy Instances -->
  <rect x="320" y="260" width="120" height="80" class="gateway" rx="5"/>
  <text x="380" y="285" text-anchor="middle" class="label">Envoy Proxy</text>
  <text x="380" y="300" text-anchor="middle" class="label">Data Plane</text>
  <text x="380" y="315" text-anchor="middle" class="label">• TLS Termination</text>
  <text x="380" y="330" text-anchor="middle" class="label">• Rate Limiting</text>
  
  <!-- WAF/Security -->
  <rect x="480" y="260" width="120" height="80" class="infrastructure" rx="5"/>
  <text x="540" y="285" text-anchor="middle" class="label">Security Layer</text>
  <text x="540" y="300" text-anchor="middle" class="label">• WAF Policies</text>
  <text x="540" y="315" text-anchor="middle" class="label">• Auth/OIDC</text>
  <text x="540" y="330" text-anchor="middle" class="label">• mTLS</text>
  
  <!-- Observability -->
  <rect x="640" y="260" width="120" height="80" class="component" rx="5"/>
  <text x="700" y="285" text-anchor="middle" class="label">Observability</text>
  <text x="700" y="300" text-anchor="middle" class="label">• Metrics</text>
  <text x="700" y="315" text-anchor="middle" class="label">• Tracing</text>
  <text x="700" y="330" text-anchor="middle" class="label">• Logging</text>
  
  <!-- Certificate Management -->
  <rect x="800" y="260" width="120" height="80" class="infrastructure" rx="5"/>
  <text x="860" y="285" text-anchor="middle" class="label">Cert Manager</text>
  <text x="860" y="300" text-anchor="middle" class="label">• Auto TLS</text>
  <text x="860" y="315" text-anchor="middle" class="label">• Let's Encrypt</text>
  <text x="860" y="330" text-anchor="middle" class="label">• Internal CA</text>
  
  <!-- Kubernetes Cluster Zone -->
  <rect x="50" y="380" width="1100" height="180" class="zone" rx="10"/>
  <text x="70" y="405" class="label">Kubernetes Cluster</text>
  
  <!-- Application Services -->
  <rect x="100" y="420" width="120" height="60" class="service" rx="5"/>
  <text x="160" y="440" text-anchor="middle" class="label">Frontend</text>
  <text x="160" y="455" text-anchor="middle" class="label">Service</text>
  <text x="160" y="470" text-anchor="middle" class="label">(React/Vue)</text>
  
  <rect x="250" y="420" width="120" height="60" class="service" rx="5"/>
  <text x="310" y="440" text-anchor="middle" class="label">API Gateway</text>
  <text x="310" y="455" text-anchor="middle" class="label">Service</text>
  <text x="310" y="470" text-anchor="middle" class="label">(REST/GraphQL)</text>
  
  <rect x="400" y="420" width="120" height="60" class="service" rx="5"/>
  <text x="460" y="440" text-anchor="middle" class="label">Microservices</text>
  <text x="460" y="455" text-anchor="middle" class="label">• User Service</text>
  <text x="460" y="470" text-anchor="middle" class="label">• Order Service</text>
  
  <!-- Service Mesh (Optional) -->
  <rect x="550" y="420" width="120" height="60" class="component" rx="5"/>
  <text x="610" y="440" text-anchor="middle" class="label">Service Mesh</text>
  <text x="610" y="455" text-anchor="middle" class="label">(Istio)</text>
  <text x="610" y="470" text-anchor="middle" class="label">East-West Traffic</text>
  
  <!-- Message Queue -->
  <rect x="700" y="420" width="120" height="60" class="service" rx="5"/>
  <text x="760" y="440" text-anchor="middle" class="label">Message Queue</text>
  <text x="760" y="455" text-anchor="middle" class="label">(Kafka/Redis)</text>
  
  <!-- Namespace Services -->
  <rect x="100" y="500" width="120" height="40" class="service" rx="5"/>
  <text x="160" y="520" text-anchor="middle" class="label">Staging Services</text>
  
  <rect x="250" y="500" width="120" height="40" class="service" rx="5"/>
  <text x="310" y="520" text-anchor="middle" class="label">Production Services</text>
  
  <rect x="400" y="500" width="120" height="40" class="service" rx="5"/>
  <text x="460" y="520" text-anchor="middle" class="label">Dev Services</text>
  
  <!-- Data Layer Zone -->
  <rect x="50" y="580" width="1100" height="140" class="zone" rx="10"/>
  <text x="70" y="605" class="label">Data & External Services</text>
  
  <!-- Databases -->
  <rect x="100" y="620" width="120" height="60" class="infrastructure" rx="5"/>
  <text x="160" y="640" text-anchor="middle" class="label">Primary DB</text>
  <text x="160" y="655" text-anchor="middle" class="label">(PostgreSQL)</text>
  <text x="160" y="670" text-anchor="middle" class="label">RDS/CloudSQL</text>
  
  <rect x="250" y="620" width="120" height="60" class="infrastructure" rx="5"/>
  <text x="310" y="640" text-anchor="middle" class="label">Cache Layer</text>
  <text x="310" y="655" text-anchor="middle" class="label">(Redis)</text>
  <text x="310" y="670" text-anchor="middle" class="label">ElastiCache</text>
  
  <!-- External APIs -->
  <rect x="400" y="620" width="120" height="60" class="external" rx="5"/>
  <text x="460" y="640" text-anchor="middle" class="label">External APIs</text>
  <text x="460" y="655" text-anchor="middle" class="label">• Payment Gateway</text>
  <text x="460" y="670" text-anchor="middle" class="label">• Identity Provider</text>
  
  <!-- Object Storage -->
  <rect x="550" y="620" width="120" height="60" class="infrastructure" rx="5"/>
  <text x="610" y="640" text-anchor="middle" class="label">Object Storage</text>
  <text x="610" y="655" text-anchor="middle" class="label">(S3/GCS)</text>
  
  <!-- Monitoring Stack -->
  <rect x="700" y="620" width="120" height="60" class="component" rx="5"/>
  <text x="760" y="640" text-anchor="middle" class="label">Monitoring</text>
  <text x="760" y="655" text-anchor="middle" class="label">• Prometheus</text>
  <text x="760" y="670" text-anchor="middle" class="label">• Grafana</text>
  
  <!-- Log Aggregation -->
  <rect x="850" y="620" width="120" height="60" class="component" rx="5"/>
  <text x="910" y="640" text-anchor="middle" class="label">Log Analytics</text>
  <text x="910" y="655" text-anchor="middle" class="label">• ELK Stack</text>
  <text x="910" y="670" text-anchor="middle" class="label">• Fluentd</text>
  
  <!-- Traffic Flow Arrows -->
  <!-- External to Load Balancer -->
  <line x1="200" y1="150" x2="450" y2="150" class="arrow"/>
  <text x="325" y="145" text-anchor="middle" class="flow-label">HTTPS</text>
  
  <!-- Load Balancer to Envoy -->
  <line x1="500" y1="180" x2="380" y2="260" class="arrow"/>
  <text x="440" y="220" text-anchor="middle" class="flow-label">TLS</text>
  
  <!-- Envoy Control Plane to Data Plane -->
  <line x1="280" y1="300" x2="320" y2="300" class="arrow"/>
  <text x="300" y="295" text-anchor="middle" class="flow-label">xDS</text>
  
  <!-- Envoy to Services -->
  <line x1="380" y1="340" x2="310" y2="420" class="arrow"/>
  <text x="345" y="380" text-anchor="middle" class="flow-label">HTTP/gRPC</text>
  
  <!-- Services to Data -->
  <line x1="310" y1="480" x2="310" y2="620" class="arrow"/>
  <text x="320" y="550" class="flow-label">SQL</text>
  
  <!-- Observability Flows -->
  <line x1="440" y1="300" x2="640" y2="300" class="arrow"/>
  <text x="540" y="295" text-anchor="middle" class="flow-label">Telemetry</text>
  
  <!-- Service to External APIs -->
  <line x1="460" y1="480" x2="460" y2="620" class="arrow"/>
  <text x="470" y="550" class="flow-label">API Calls</text>
  
  <!-- Legend -->
  <rect x="900" y="80" width="250" height="160" fill="white" stroke="#bdc3c7" stroke-width="1" rx="5"/>
  <text x="920" y="100" class="subtitle">Legend</text>
  
  <rect x="920" y="110" width="20" height="15" class="gateway"/>
  <text x="950" y="122" class="label">Envoy Gateway Components</text>
  
  <rect x="920" y="130" width="20" height="15" class="service"/>
  <text x="950" y="142" class="label">Application Services</text>
  
  <rect x="920" y="150" width="20" height="15" class="infrastructure"/>
  <text x="950" y="162" class="label">Infrastructure Components</text>
  
  <rect x="920" y="170" width="20" height="15" class="component"/>
  <text x="950" y="182" class="label">Operational Components</text>
  
  <rect x="920" y="190" width="20" height="15" class="external"/>
  <text x="950" y="202" class="label">External Systems</text>
  
  <line x1="920" y1="220" x2="940" y2="220" class="arrow"/>
  <text x="950" y="224" class="label">Traffic Flow</text>
</svg>
