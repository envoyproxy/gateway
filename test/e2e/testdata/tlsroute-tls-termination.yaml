# Certificate for TLS termination - Wildcard cert for *.example.com
# openssl req -x509 -sha256 -nodes -days 3650 -newkey rsa:2048 -subj '/O=example Inc./CN=*.example.com' -keyout tls.key -out tls.crt
apiVersion: v1
data:
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRRG5zbHN5Q21VQmxmMTgKT0htNkNKRkdYeGNMWkF2TGhyWkdZK0NGTFpwTW5IaVhDTTRYLzB4V0ViS2d3TGJTd3c4RURISXZlVElSajNvQQpta2l0d2t2UUZiUkZSUnlDSlNjOXNMb1MzY2hPcEp5TlUxdEYrenYraHAvQlR6L0VGMHBqMUZJdDBYc0g3UlZIClRaaDBnUzdlYm53T3RhNU51WEFuYmFCakhxdVJmQVZPUWcrZDNCSU9kZXhzZkJvNFN5TEc4VHRsYis4bXVOY24KTll6UFVtQW01NkE4SmNsblVxc2U3aTVDWXdZeWlRZnJCNk5NS043c1YwR2p6enE0RHB5WHMxZWoxZmpGQmpKUwpxVlAzTm5FcEoyaWFsbC9yYzlUNXQ0Q0lqTjNPTEVUSHNRdUFLekdVQTkxQkQ2KzhuUUd0eGhUREhzRlhWdnRJCmN0UmVtZFdMQWdNQkFBRUNnZ0VBRG9Pd1RkS3o0Q1VPdzV6Z0YwVFpJUER0QnlRbHp3S3A0WC81UFM2TnAzWDMKNGZKRnd1QVYzcUJ1TWI3UTFTUXVDU0ZrZDgvZVVKWk4zTUxOZ2NFVnNidmlWcUtOTmlQd3NOOGswUEMrenhwbAp5ajZxRFppKytlTmlGNkNJekpadTdSRU1jdDFZR1RlRGFUdVZyTnE0M210S2J6dDNaMXdTQ0E1SWlWME8vMmFJCmhMVTE4TXg4Y3d6c0dmMEdKRkJndkMzcVdkdG1uL1BZVlFVV2x0Wi83LzF6NG5CNGhjZ0oxU0N0Uk9PejNWbzcKMDRKMWpiRitQTWFkNWFQQVVGa1ozR0RNY3I2ZVlLbVc2a1pqa3hEWDRSTGJwTHl5Vm1MOTNndGNMc0ZWL0tIbQpSQS9GWXZQUXNjUTk3ZmVzSmZ3REl1eXpraUw0VTZSVkxqZ1FtUjk1T1FLQmdRRDF3WGw5SEN4NXQ3cWlpYXZjCmdoMTlGbXZZUHluUDc0Y1BSVmFYNkpvTEVrbXVtTFBHMk1rUjV1bkU4MjAxSWJHRitud2dIY2pvVThFYU1kREQKc1NFeWxBekNwZW9ZbE1Wa0FmSVRuWVdZU0pGZk5nc1JESEhXRnBabEFZR1poMU0zV3pZYkFzTk5UNnk3UXJUSAp5c20zZHF0ayt0SEFQNTRMMkFtRjlOZjdxUUtCZ1FEeFd0cU5kSWlUaVA5KzlMdVg0enFWT1dHMzE2REpyRlMyCmxrMFp3Z1N6Vk5HVS9DK2lrMzJ1ZUwzVTNnbFJhNy8xRUV3WDA2MFI3QTdzK0p3cUl2NGN3ZHNZbHhmY0hpd1IKWXc5K1haZlltaFFiRUllL3lxRFVnN1lmYXVPdjUzT0RWeGNNb1I5MDdTUHRRbERzQk9WbGgrVlBqQWdpa2cyLwo2OHdlcXhub0V3S0JnSHNqZElKUnlaODdobExHOU14S2pnZ05ZZ0E2dGZLd3JGWGtnbDBmZVlBdXE2akdidDRsCjVhb0lyLzIxazNUWjZ4K2N3UEUrdTFwZURSWFkvQ2Z4NnhaeXhHb0x4RjZJdk5jOWVsU0Z5MWpnazZiSFo0Z2wKV2l6UnFJMzMwVDVpWmpvSWcvWEl6cDlBV3VhQnFCK3I1cUw4M1NoOTNQZWRhTTI2ZEJzZzhjL3hBb0dCQUpVYwpKVlFwUDh1dVl2TGpiaFpiZXpFQUgzLytCc2N4NGJCZ1VVZnRsd3ZZQmhkK2FrdU54YU1KMDNYMHExc1RMNmZPCnBzUTlzWG9XRmU2UGRhT090T0c5WG9mbHFRY0QyUVB3Nkh5UWhDUjhwSmxIOENZc29JcEt5VFRGeTk4OEppQnAKcU1MVHRHUi9zYWQrUmhKYXdBS25INk95aHNBYzdjTzVnUVVkZmtiakFvR0JBS1BlSFU3MDFmYjR4QkM2aUdsVgo4NVBLZzRVeGpDbEljQkw0amM5MWdMY1pBWEtIVWxzT0U1a00xYVJodlQyQUpzRmpKRnp5MHZmNkMrRE9BZUJ3ClRhN3hDMHVBbjc1R3lBVy9jZitYSnNHVEt4R0JoVVZCSXkzZkVOVTQ1UTNyZkRFSE1jTzVvRGQrS1p6Mk1SWWgKbW9qYnp5eVJ0VklHVy9kZUpEQ1FiRFlrCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURXakNDQWtLZ0F3SUJBZ0lVSk9taGNTTHR6LzVRU2tvcitaOFpvOWVocnlNd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0x6RVZNQk1HQTFVRUNnd01aWGhoYlhCc1pTQkpibU11TVJZd0ZBWURWUVFEREEwcUxtVjRZVzF3YkdVdQpZMjl0TUI0WERUSTFNVEl3TlRBNE1EWXdNMW9YRFRNMU1USXdNekE0TURZd00xb3dMekVWTUJNR0ExVUVDZ3dNClpYaGhiWEJzWlNCSmJtTXVNUll3RkFZRFZRUUREQTBxTG1WNFlXMXdiR1V1WTI5dE1JSUJJakFOQmdrcWhraUcKOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTU3SmJNZ3BsQVpYOWZEaDV1Z2lSUmw4WEMyUUx5NGEyUm1QZwpoUzJhVEp4NGx3ak9GLzlNVmhHeW9NQzIwc01QQkF4eUwza3lFWTk2QUpwSXJjSkwwQlcwUlVVY2dpVW5QYkM2CkV0M0lUcVNjalZOYlJmczcvb2Fmd1U4L3hCZEtZOVJTTGRGN0IrMFZSMDJZZElFdTNtNThEcld1VGJsd0oyMmcKWXg2cmtYd0ZUa0lQbmR3U0RuWHNiSHdhT0VzaXh2RTdaVy92SnJqWEp6V016MUpnSnVlZ1BDWEpaMUtySHU0dQpRbU1HTW9rSDZ3ZWpUQ2plN0ZkQm84ODZ1QTZjbDdOWG85WDR4UVl5VXFsVDl6WnhLU2RvbXBaZjYzUFUrYmVBCmlJemR6aXhFeDdFTGdDc3hsQVBkUVErdnZKMEJyY1lVd3g3QlYxYjdTSExVWHBuVml3SURBUUFCbzI0d2JEQkwKQmdOVkhSRUVSREJDZ2cwcUxtVjRZVzF3YkdVdVkyOXRnZzltYjI4dVpYaGhiWEJzWlM1amIyMkNEMkpoY2k1bAplR0Z0Y0d4bExtTnZiWUlQWW1GNkxtVjRZVzF3YkdVdVkyOXRNQjBHQTFVZERnUVdCQlFLbWNMbHFOVjlJei9DCnZZYWFhLzVaTkxESFJUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFEZExaRHFQdllYc0d6YjFyektjY1pQV1IKNFMxYS9rNEl4Nk1yaExaRFc4YmdiL3hNalpqeHVMRVJGNk9YYlViazhuOFdaeWhpalY5SXZ2alZ2K1pGRVc4VQpnNjJnaWlyREFnVXp6SUc2RkdLejRvU2l5dmpGMnhUdURNY1J1Y0U5OFE4dnNUV0c1TU51L0lsdTlnbzg4Q3dwCkdNMlc0clRoVG05U3dBWi9XNE9NNlRpNHdBUldzUHJ5am5QZlIralQzUUVBcXJHMWNoZ3BKU29qSmhlK3p0RW4KaURkNmdMSFhKUUN5WnNJRklsRFdWVzdmVUEvNHNpUFB1dGxmc3JjY3gweW43WlVkU0k1ZkVzWm9jUkJBSFN3WgpIUFVwTlBoMno1ajZEOUNDVG5jQTVNbXRHNCtjdjNtMyt3eHFseUozWFhrSGd3SUtwWkNjbFNyVXRkL2t2dz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURXakNDQWtLZ0F3SUJBZ0lVSk9taGNTTHR6LzVRU2tvcitaOFpvOWVocnlNd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0x6RVZNQk1HQTFVRUNnd01aWGhoYlhCc1pTQkpibU11TVJZd0ZBWURWUVFEREEwcUxtVjRZVzF3YkdVdQpZMjl0TUI0WERUSTFNVEl3TlRBNE1EWXdNMW9YRFRNMU1USXdNekE0TURZd00xb3dMekVWTUJNR0ExVUVDZ3dNClpYaGhiWEJzWlNCSmJtTXVNUll3RkFZRFZRUUREQTBxTG1WNFlXMXdiR1V1WTI5dE1JSUJJakFOQmdrcWhraUcKOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTU3SmJNZ3BsQVpYOWZEaDV1Z2lSUmw4WEMyUUx5NGEyUm1QZwpoUzJhVEp4NGx3ak9GLzlNVmhHeW9NQzIwc01QQkF4eUwza3lFWTk2QUpwSXJjSkwwQlcwUlVVY2dpVW5QYkM2CkV0M0lUcVNjalZOYlJmczcvb2Fmd1U4L3hCZEtZOVJTTGRGN0IrMFZSMDJZZElFdTNtNThEcld1VGJsd0oyMmcKWXg2cmtYd0ZUa0lQbmR3U0RuWHNiSHdhT0VzaXh2RTdaVy92SnJqWEp6V016MUpnSnVlZ1BDWEpaMUtySHU0dQpRbU1HTW9rSDZ3ZWpUQ2plN0ZkQm84ODZ1QTZjbDdOWG85WDR4UVl5VXFsVDl6WnhLU2RvbXBaZjYzUFUrYmVBCmlJemR6aXhFeDdFTGdDc3hsQVBkUVErdnZKMEJyY1lVd3g3QlYxYjdTSExVWHBuVml3SURBUUFCbzI0d2JEQkwKQmdOVkhSRUVSREJDZ2cwcUxtVjRZVzF3YkdVdVkyOXRnZzltYjI4dVpYaGhiWEJzWlM1amIyMkNEMkpoY2k1bAplR0Z0Y0d4bExtTnZiWUlQWW1GNkxtVjRZVzF3YkdVdVkyOXRNQjBHQTFVZERnUVdCQlFLbWNMbHFOVjlJei9DCnZZYWFhLzVaTkxESFJUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFEZExaRHFQdllYc0d6YjFyektjY1pQV1IKNFMxYS9rNEl4Nk1yaExaRFc4YmdiL3hNalpqeHVMRVJGNk9YYlViazhuOFdaeWhpalY5SXZ2alZ2K1pGRVc4VQpnNjJnaWlyREFnVXp6SUc2RkdLejRvU2l5dmpGMnhUdURNY1J1Y0U5OFE4dnNUV0c1TU51L0lsdTlnbzg4Q3dwCkdNMlc0clRoVG05U3dBWi9XNE9NNlRpNHdBUldzUHJ5am5QZlIralQzUUVBcXJHMWNoZ3BKU29qSmhlK3p0RW4KaURkNmdMSFhKUUN5WnNJRklsRFdWVzdmVUEvNHNpUFB1dGxmc3JjY3gweW43WlVkU0k1ZkVzWm9jUkJBSFN3WgpIUFVwTlBoMno1ajZEOUNDVG5jQTVNbXRHNCtjdjNtMyt3eHFseUozWFhrSGd3SUtwWkNjbFNyVXRkL2t2dz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
kind: Secret
metadata:
  name: tls-termination-certificate
  namespace: gateway-conformance-infra
type: kubernetes.io/tls
---
# Gateway with TLS listener in Terminate mode
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: tlsroute-termination-gateway
  namespace: gateway-conformance-infra
spec:
  gatewayClassName: "{GATEWAY_CLASS_NAME}"
  listeners:
    - name: tls
      protocol: TLS
      port: 8443
      hostname: "*.example.com"
      tls:
        certificateRefs:
          - group: ""
            kind: Secret
            name: tls-termination-certificate
        mode: Terminate
      allowedRoutes:
        namespaces:
          from: All
---
# TLSRoute 1: foo.example.com -> infra-backend-v1
apiVersion: gateway.networking.k8s.io/v1alpha2
kind: TLSRoute
metadata:
  name: tlsroute-terminate-1
  namespace: gateway-conformance-infra
spec:
  parentRefs:
    - name: tlsroute-termination-gateway
      sectionName: tls
  hostnames:
    - "foo.example.com"
  rules:
    - backendRefs:
        - name: infra-backend-v1
          port: 8080
---
# TLSRoute 2: bar.example.com -> infra-backend-v2
apiVersion: gateway.networking.k8s.io/v1alpha2
kind: TLSRoute
metadata:
  name: tlsroute-terminate-2
  namespace: gateway-conformance-infra
spec:
  parentRefs:
    - name: tlsroute-termination-gateway
      sectionName: tls
  hostnames:
    - "bar.example.com"
  rules:
    - backendRefs:
        - name: infra-backend-v2
          port: 8080
---
# TLSRoute 3: baz.example.com -> infra-backend-v3
apiVersion: gateway.networking.k8s.io/v1alpha2
kind: TLSRoute
metadata:
  name: tlsroute-terminate-3
  namespace: gateway-conformance-infra
spec:
  parentRefs:
    - name: tlsroute-termination-gateway
      sectionName: tls
  hostnames:
    - "baz.example.com"
  rules:
    - backendRefs:
        - name: infra-backend-v3
          port: 8080
