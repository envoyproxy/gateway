apiVersion: v1
kind: ConfigMap
metadata:
  name: envoy-gateway-config
  namespace: '{{ .Release.Namespace }}'
  labels:
  {{- include "eg.labels" . | nindent 4 }}
data:
  envoy-gateway.yaml: |
    apiVersion: config.gateway.envoyproxy.io/v1alpha1
    gateway:
      controllerName: {{ .Values.config.envoyGateway.gateway.controllerName
        | quote }}
    kind: EnvoyGateway
    provider:
      {{- toYaml .Values.config.envoyGateway.provider | nindent 6 }}
    {{- if .Values.config.envoyGateway.rateLimit }}
    rateLimit:
      {{- toYaml .Values.config.envoyGateway.rateLimit | nindent 6 }}
    {{- end }}
    {{- if .Values.config.envoyGateway.extension }}
    extension:
      {{- toYaml .Values.config.envoyGateway.extension | nindent 6 }}
    {{- end }}
    logging:
      level:
        default: info
